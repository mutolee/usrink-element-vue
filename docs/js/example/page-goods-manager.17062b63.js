import{j as we,r as p,i as de,f as Ve,s as ke,B as Ne,ah as t,o as r,c as f,W as e,Q as l,a,L as ee,F as B,a9 as E,P as y,U as n,V as v,u as I,T as L,aa as xe,n as Te,bi as Ce,bg as Se}from"../@vue/@vue.5ea14220.js";import{T as ze,E as Ue}from"../@wangeditor/@wangeditor.654f9dc1.js";import{u as je}from"../../assets/index-1d250c46.js";import{S as Ie}from"../sku-single/sku-single.0293c49f.js";import{R as qe,n as ne,P as Ge}from"../@element-plus/@element-plus.99d8e261.js";import{I as De}from"../image-cutter-dialog/image-cutter-dialog.9b709df6.js";import{c as ue}from"../CacheUtil/CacheUtil.bf4ebc65.js";import{_ as ie}from"../vue-img-cutter/vue-img-cutter.3d5e4c17.js";import"../pinia/pinia.fb187a93.js";import"../vue-router/vue-router.6ed6991e.js";import"../localforage/localforage.9e9e3b2b.js";import"../@kangc/@kangc.f59435d2.js";import"../vue/vue.1c0a12e0.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../axios/axios.47b9d439.js";import"../element-plus/element-plus.33c2f463.js";import"../lodash-es/lodash-es.21c98b27.js";import"../@vueuse/@vueuse.71e72d96.js";import"../@popperjs/@popperjs.c75af06c.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.10495895.js";import"../async-validator/async-validator.dee29e8b.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../escape-html/escape-html.66262ebd.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.72671fae.js";import"../echarts/echarts.3025caf6.js";import"../tslib/tslib.54e39b60.js";import"../zrender/zrender.7e5d4d80.js";import"../vue-echarts/vue-echarts.8b3ad32f.js";import"../resize-detector/resize-detector.a5205554.js";import"../nprogress/nprogress.d255c298.js";import"../highlight.js/highlight.js.1b3e8c39.js";const Fe=N=>(Ce("data-v-5d04ab70"),N=N(),Se(),N),Re={class:"vel_cpt_panel_drawer_add_goods"},Be=Fe(()=>a("h4",null,"添加商品",-1)),Ee={class:"dialog_con"},Me={class:"page_left_con"},Le={class:"preview"},Pe={class:"preview_con"},We={class:"shop_carousel_list"},He={class:"shop_info_panel"},Ke={class:"tit_panel"},Oe={class:"tit_item price"},$e={class:"price_real"},Ae={class:"tit_item tit"},Qe={class:"share"},Je={class:"share_con"},Xe={key:0,class:"tit_item desc"},Ye={key:1,class:"tit_item tags"},Ze={class:"sku_panel"},el={style:{"padding-bottom":"10px"}},ll={class:"sku_info"},tl={class:"sku_right"},ol={class:"choose_more_arrow"},al={class:"choose_time_panel"},sl={style:{"padding-bottom":"10px"}},nl={class:"time_panel"},dl={class:"choose_more_arrow"},ul={class:"detail_panel"},il=["innerHTML"],rl={class:"preview_publish"},pl={class:"page_right_con"},_l={class:"add_goods_panel"},cl={class:"shop_thumbs"},ml={class:"mask"},M=400,hl={__name:"add-goods-dialog",props:["dialog"],emits:["onConfirm"],setup(N,{emit:g}){const O=je(),C=we(()=>O.wh.w-260),d=p({shopNo:"",shopName:"",shopType:[],thumbs:[],unit:"0",skus:[],status:"1"}),S=p([]);de(()=>{$()});const $=()=>{ue.getShopTypeExcludeDisabled().then(i=>{S.value.push(...i)}).catch(i=>{console.error(i)})},m=p([{name:"",price:.01,delPrice:.02,count:99}]);Ve(m.value,i=>{d.value.skus=i});const _=ke(),z=p("<p></p>"),x={toolbarKeys:["headerSelect","|","bold","italic","through","underline","color","bgColor","fontSize","blockquote","|","insertTable","uploadImage"]},A={placeholder:"请输入内容...",scroll:!1,MENU_CONF:{uploadImage:{base64LimitSize:5*1024,async customUpload(i,s){q(i,w=>{s(w,"","javascript:(0);")})}}},hoverbarKeys:{image:{menuKeys:[]}}},q=(i,s)=>{let w=1048576;if(console.log(i),i.size>w){ElMessage.error("单张图片不能大于1M！");return}s("https://fuss10.elemecdn.com/d/e6/c4d93a3805b3ce3f323f7974e6f78jpeg.jpeg")},Q=i=>{_.value=i};Ne(()=>{const i=_.value;i!=null&&i.destroy()});const c=p([]),T=p(""),U=p(!1),G=p(null),V=i=>{c.value.splice(c.value.indexOf(i),1)},D=()=>{T.value&&c.value.push(T.value),U.value=!1,T.value=""},J=()=>{U.value=!0,Te(()=>{G.value&&G.value.focus()})};p([]);const j=p({show:!1});let P=0;const X=i=>{P++,d.value.thumbs.push({id:P,src:i.dataURL}),W.value.validateField("thumbs")},Y=()=>{j.value.show=!0},u=p([{label:"天",value:"0",disabled:!1},{label:"月",value:"1",disabled:!0},{label:"小时",value:"2",disabled:!0}]),re=(M-40)*.7,pe=p({shopNo:[{required:!0,message:"编号不能为空！",trigger:"blur"}],shopName:[{required:!0,message:"商品名称不能为空！",trigger:"blur"},{min:8,max:40,message:"长度在 8 到 40 个字符",trigger:"blur"}],thumbs:[{required:!0,message:"商品图不能为空，请选择商品图！",trigger:"change"}],shopType:[{required:!0,message:"请选择商品分类",trigger:"change"}],unit:[{required:!0,message:"请选择价格单位",trigger:"change"}],skus:[{required:!0,validator:(i,s,w)=>{let F=!0;if(s.length===0)F=!1;else for(let k=0;k<s.length;k++)if(s[k].name===""||s[k].price===null||s[k].delPrice===null||s[k].count===null){F=!1;break}F?(console.log("规格验证通过"),w()):w(new Error("请完善规格信息！"))},trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),W=p(null),_e=async()=>{try{await W.value.validate(),console.log("表单验证通过")}catch{console.log("表单验证未通过")}},ce=()=>{W.value.validateField("skus")};return(i,s)=>{const w=t("el-image"),F=t("el-carousel-item"),k=t("el-carousel"),h=t("el-text"),R=t("el-icon"),le=t("el-tag"),te=t("el-step"),me=t("el-steps"),oe=t("el-tab-pane"),he=t("el-tabs"),Z=t("el-scrollbar"),ae=t("el-button"),H=t("el-input"),b=t("el-form-item"),fe=t("Plus"),ve=t("el-cascader"),K=t("el-option"),se=t("el-select"),ge=t("el-form"),be=t("el-card"),ye=t("el-drawer");return r(),f("div",Re,[e(ye,{modelValue:N.dialog.show,"onUpdate:modelValue":s[8]||(s[8]=o=>N.dialog.show=o),size:C.value,direction:"rtl",class:"vel_drawer_override"},{header:l(()=>[Be]),default:l(()=>[e(Z,null,{default:l(()=>[a("div",Ee,[a("div",{class:"page_left",style:ee({width:M+"px",minWidth:M+"px"})},[a("div",Me,[a("div",Le,[a("div",Pe,[e(Z,null,{default:l(()=>[a("div",We,[e(k,{height:re+"px"},{default:l(()=>[(r(!0),f(B,null,E(d.value.thumbs,o=>(r(),y(F,{key:o.id},{default:l(()=>[e(w,{src:o.src,fit:"fill",style:{width:"100%"}},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["height"])]),a("div",He,[a("div",Ke,[a("div",Oe,[a("span",$e,[e(h,null,{default:l(()=>[n("￥")]),_:1}),e(h,{style:{"font-size":"22px"},tag:"b"},{default:l(()=>[n(v(m.value[0].price),1)]),_:1}),e(h,null,{default:l(()=>[n("/"+v(u.value[0].label),1)]),_:1})]),e(h,{type:"info",tag:"del",size:"small"},{default:l(()=>[n("￥"+v(m.value[0].delPrice)+"/"+v(u.value[0].label),1)]),_:1})]),a("div",Ae,[e(h,{class:"txt",tag:"b"},{default:l(()=>[n(v(d.value.shopName),1)]),_:1}),a("div",Qe,[a("div",Je,[e(R,null,{default:l(()=>[e(I(qe))]),_:1}),e(h,{size:"small"},{default:l(()=>[n("分享")]),_:1})])])]),d.value.desc!==""?(r(),f("div",Xe,[e(h,{type:"info",size:"small"},{default:l(()=>[n(v(d.value.desc),1)]),_:1})])):L("",!0),c.value.length>0?(r(),f("div",Ye,[(r(!0),f(B,null,E(c.value,o=>(r(),y(le,{key:o,type:"danger",size:"small",effect:"plain"},{default:l(()=>[n(v(o),1)]),_:2},1024))),128))])):L("",!0)]),a("div",Ze,[a("div",el,[e(h,{tag:"b"},{default:l(()=>[n("规格")]),_:1})]),a("div",ll,[e(h,{class:"sku_name",type:"info",size:"small"},{default:l(()=>[n(v(m.value[0].name),1)]),_:1}),a("div",tl,[e(h,{class:"sku_num",type:"info"},{default:l(()=>[n("x1")]),_:1}),a("div",ol,[e(R,null,{default:l(()=>[e(I(ne))]),_:1})])])])]),a("div",al,[a("div",sl,[e(h,{tag:"b"},{default:l(()=>[n("租赁周期")]),_:1})]),a("div",nl,[e(me,{direction:"vertical",active:1,space:40},{default:l(()=>[e(te,{status:"wait"},{description:l(()=>[n(" 开始时间 : 2023-11-26 ")]),_:1}),e(te,{status:"wait"},{description:l(()=>[n(" 结束时间 : 2023-11-26 ")]),_:1})]),_:1}),a("div",dl,[e(R,null,{default:l(()=>[e(I(ne))]),_:1})])])]),a("div",ul,[e(he,{model:0},{default:l(()=>[e(oe,{label:"商品详情",class:"goods_detail"},{default:l(()=>[a("div",{innerHTML:z.value},null,8,il)]),_:1}),e(oe,{label:"租赁流程"},{default:l(()=>[n("Config")]),_:1})]),_:1})])])]),_:1})]),a("div",rl,[e(ae,{type:"primary",size:"large",onClick:_e},{default:l(()=>[n("保存 ")]),_:1})])])])],4),a("div",{class:"page_right",style:ee({width:C.value-M+"px"})},[a("div",pl,[e(be,{shadow:"never",class:"vel_card_override"},{default:l(()=>[a("div",_l,[e(Z,null,{default:l(()=>[e(ge,{model:d.value,ref_key:"formRef",ref:W,rules:pe.value,"label-width":"120px"},{default:l(()=>[e(b,{label:"商品编号",prop:"shopNo",style:{"padding-top":"20px"}},{default:l(()=>[e(H,{modelValue:d.value.shopNo,"onUpdate:modelValue":s[0]||(s[0]=o=>d.value.shopNo=o),clearable:"",style:{width:"150px"}},null,8,["modelValue"])]),_:1}),e(b,{label:"商品名称",prop:"shopName"},{default:l(()=>[e(H,{modelValue:d.value.shopName,"onUpdate:modelValue":s[1]||(s[1]=o=>d.value.shopName=o),clearable:"",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),e(b,{label:"促销信息"},{default:l(()=>[e(H,{modelValue:d.value.desc,"onUpdate:modelValue":s[2]||(s[2]=o=>d.value.desc=o),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入简短的描述信息，100个字符以内！"},null,8,["modelValue"])]),_:1}),e(b,{label:"商品图",prop:"thumbs",class:"shop_images"},{default:l(()=>[a("div",cl,[(r(!0),f(B,null,E(d.value.thumbs,o=>(r(),f("div",{class:"shop_img_list",key:o.id},[e(w,{class:"shop_img",src:o.src,fit:"fill"},null,8,["src"]),a("span",ml,[e(R,null,{default:l(()=>[e(I(Ge))]),_:1})])]))),128)),d.value.thumbs.length<7?(r(),f("div",{key:0,class:"el-upload--picture-card",onClick:Y},[e(R,null,{default:l(()=>[e(fe)]),_:1})])):L("",!0)])]),_:1}),e(b,{class:"shop_tags",label:"商品标签"},{default:l(()=>[(r(!0),f(B,null,E(c.value,o=>(r(),y(le,{key:o,size:"large",closable:"","disable-transitions":!1,onClose:kl=>V(o)},{default:l(()=>[n(v(o),1)]),_:2},1032,["onClose"]))),128)),U.value?(r(),y(H,{key:0,modelValue:T.value,"onUpdate:modelValue":s[3]||(s[3]=o=>T.value=o),size:"default",ref_key:"inputRef",ref:G,onKeyup:xe(D,["enter"]),onBlur:D,style:{width:"100px"}},null,8,["modelValue","onKeyup"])):(r(),y(ae,{key:1,size:"default",onClick:J},{default:l(()=>[n(" + 添加标签 ")]),_:1}))]),_:1}),e(b,{label:"商品分类",prop:"shopType"},{default:l(()=>[e(ve,{props:{expandTrigger:"hover",value:"id",label:"name"},options:S.value,size:"default",modelValue:d.value.shopType,"onUpdate:modelValue":s[4]||(s[4]=o=>d.value.shopType=o),clearable:"",placeholder:"选择分类"},null,8,["options","modelValue"])]),_:1}),e(b,{label:"规格",prop:"skus",class:"sku_panel"},{default:l(()=>[e(Ie,{skus:m.value,onOnDelSkuRow:ce},null,8,["skus"])]),_:1}),e(b,{label:"价格单位",prop:"unit"},{default:l(()=>[e(se,{modelValue:d.value.unit,"onUpdate:modelValue":s[5]||(s[5]=o=>d.value.unit=o),size:"default",clearable:"",placeholder:"选择单位"},{default:l(()=>[(r(!0),f(B,null,E(u.value,o=>(r(),y(K,{key:o.value,label:o.label,value:o.value,disabled:o.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"状态",prop:"status"},{default:l(()=>[e(se,{modelValue:d.value.status,"onUpdate:modelValue":s[6]||(s[6]=o=>d.value.status=o),clearable:"",size:"default",placeholder:"选择状态"},{default:l(()=>[e(K,{label:"已上架",value:"0"}),e(K,{label:"待上架",value:"1"}),e(K,{label:"已下架",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"商品描述"},{default:l(()=>[a("div",{class:"shop_editor",style:ee({maxWidth:C.value-M-200+"px"})},[e(I(ze),{style:{"border-bottom":"1px solid #e0e0e0"},editor:_.value,defaultConfig:x,mode:"simple"},null,8,["editor"]),e(I(Ue),{style:{"min-height":"400px","overflow-y":"hidden"},modelValue:z.value,"onUpdate:modelValue":s[7]||(s[7]=o=>z.value=o),defaultConfig:A,mode:"simple",onOnCreated:Q},null,8,["modelValue"])],4)]),_:1})]),_:1},8,["model","rules"])]),_:1})])]),_:1})])],4),e(De,{dialog:j.value,onOnConfirm:X,"cut-width":300,"cut-height":210},null,8,["dialog"])])]),_:1})]),_:1},8,["modelValue","size"])])}}},fl=ie(hl,[["__scopeId","data-v-5d04ab70"]]);const vl={class:"page"},gl={class:"shop_name"},bl={class:"shop_type"},yl={class:"action_btn"},wl={__name:"page-goods-manager",setup(N){const g=p({shopNo:"",shopName:"",shopType:[],status:""}),O=p([{shopNo:"#1",shopName:"联想笔记本电脑办公轻薄",thumb:"https://img1.360buyimg.com/da/jfs/t1/206354/38/39088/64192/6577c7adFfe90680e/5fad216f3b2bf8d3.jpg!q70.jpg",shopTypeName:"电脑-笔记本",status:"2"},{shopNo:"#2",shopName:"联想笔记本电脑办公轻薄本学生本15.6英寸V15 全新升级赛扬N45008GB256G",thumb:"https://img1.360buyimg.com/da/jfs/t1/206354/38/39088/64192/6577c7adFfe90680e/5fad216f3b2bf8d3.jpg!q70.jpg",shopTypeName:"电脑-笔记本",status:"1"},{shopNo:"#3",shopName:"联想笔记本电脑办公轻薄本学生本15.6英寸V15 全新升级赛扬N45008GB256G",thumb:"https://img1.360buyimg.com/da/jfs/t1/206354/38/39088/64192/6577c7adFfe90680e/5fad216f3b2bf8d3.jpg!q70.jpg",shopTypeName:"电脑-笔记本",status:"1"},{shopNo:"#4",shopName:"联想笔记本电脑办公轻薄本学生本15.6英寸V15 全新升级赛扬N45008GB256G",thumb:"https://img1.360buyimg.com/da/jfs/t1/206354/38/39088/64192/6577c7adFfe90680e/5fad216f3b2bf8d3.jpg!q70.jpg",shopTypeName:"电脑-笔记本",status:"0"},{shopNo:"#5",shopName:"联想笔记本电脑办公轻薄本学生本15.6英寸V15 全新升级赛扬N45008GB256G",thumb:"https://img1.360buyimg.com/da/jfs/t1/206354/38/39088/64192/6577c7adFfe90680e/5fad216f3b2bf8d3.jpg!q70.jpg",shopTypeName:"电脑-笔记本",status:"1"}]),C=p([]);de(()=>{d()});const d=()=>{ue.getShopTypeExcludeDisabled().then(m=>{console.log(m),C.value.push(...m)}).catch(m=>{console.error(m)})},S=p({show:!1}),$=()=>{S.value.show=!0};return(m,_)=>{const z=t("el-input"),x=t("el-form-item"),A=t("el-cascader"),q=t("el-option"),Q=t("el-select"),c=t("el-button"),T=t("el-form"),U=t("el-card"),G=t("el-row"),V=t("el-table-column"),D=t("el-text"),J=t("el-image"),j=t("el-tag"),P=t("el-empty"),X=t("el-table"),Y=t("el-pagination");return r(),f("div",vl,[e(U,{shadow:"never",class:"vel_card_override top"},{default:l(()=>[e(T,{inline:!0,model:g.value,class:"-form-inline"},{default:l(()=>[e(x,{label:"编号"},{default:l(()=>[e(z,{modelValue:g.value.shopNo,"onUpdate:modelValue":_[0]||(_[0]=u=>g.value.shopNo=u),placeholder:"商品编号",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(x,{label:"名称"},{default:l(()=>[e(z,{modelValue:g.value.shopName,"onUpdate:modelValue":_[1]||(_[1]=u=>g.value.shopName=u),placeholder:"商品名称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(x,{label:"分类"},{default:l(()=>[e(A,{props:{expandTrigger:"hover",value:"id",label:"name"},options:C.value,size:"default",modelValue:g.value.shopType,"onUpdate:modelValue":_[2]||(_[2]=u=>g.value.shopType=u),clearable:"",placeholder:"选择分类"},null,8,["options","modelValue"])]),_:1}),e(x,{label:"状态"},{default:l(()=>[e(Q,{modelValue:g.value.status,"onUpdate:modelValue":_[3]||(_[3]=u=>g.value.status=u),size:"default",placeholder:"选择状态",clearable:""},{default:l(()=>[e(q,{label:"已上架",value:"0"}),e(q,{label:"待上架",value:"1"}),e(q,{label:"已下架",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:l(()=>[e(c,{type:"primary",plain:"",onClick:_[4]||(_[4]=()=>{})},{default:l(()=>[n("搜索")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(G,{class:"top_btn_panel"},{default:l(()=>[e(c,{type:"primary",onClick:$},{default:l(()=>[n("添加商品")]),_:1})]),_:1}),e(U,{shadow:"never",class:"vel_card_override content"},{default:l(()=>[e(X,{class:"shop_table",data:O.value},{empty:l(()=>[e(P,{description:"暂无数据"})]),default:l(()=>[e(V,{prop:"shopNo",label:"编号",sortable:"",width:"100"}),e(V,{label:"商品名称","min-width":"250"},{default:l(u=>[a("div",gl,[e(D,null,{default:l(()=>[n(v(u.row.shopName),1)]),_:2},1024)])]),_:1}),e(V,{prop:"thumb",label:"缩略图","min-width":"150"},{default:l(u=>[e(J,{class:"goods_thumb",src:u.row.thumb},null,8,["src"])]),_:1}),e(V,{label:"分类",width:"180"},{default:l(u=>[a("div",bl,[e(D,null,{default:l(()=>[n(v(u.row.shopTypeName),1)]),_:2},1024)])]),_:1}),e(V,{prop:"status",label:"状态",sortable:"",width:"120"},{default:l(u=>[u.row.status==="0"?(r(),y(j,{key:0},{default:l(()=>[n("已上架")]),_:1})):u.row.status==="1"?(r(),y(j,{key:1,type:"warning"},{default:l(()=>[n("待上架")]),_:1})):u.row.status==="2"?(r(),y(j,{key:2,type:"info"},{default:l(()=>[n("已下架")]),_:1})):L("",!0)]),_:1}),e(V,{fixed:"right",label:"操作",width:"230"},{default:l(u=>[a("div",yl,[e(c,{type:"success",plain:""},{default:l(()=>[n("编辑")]),_:1}),e(c,{type:"primary",plain:""},{default:l(()=>[n("详情")]),_:1}),e(c,{type:"danger",plain:""},{default:l(()=>[n("删除")]),_:1})])]),_:1})]),_:1},8,["data"]),e(Y,{background:"",layout:"prev, pager, next",total:1e3})]),_:1}),S.value.show?(r(),y(fl,{key:0,dialog:S.value,onOnConfirm:_[5]||(_[5]=()=>{})},null,8,["dialog"])):L("",!0)])}}},ot=ie(wl,[["__scopeId","data-v-ca5a7072"]]);export{ot as default};
