import{r as c,ah as t,o as u,c as g,W as e,Q as l,a as o,U as a,F as E,a9 as G,P as y,V as b,u as q,T as L,i as J,L as ae,aa as se,n as ne,bi as ie,bg as ue,ar as de,R as re}from"../@vue/@vue.5ea14220.js";import{u as _e}from"../usr-sku-single/usr-sku-single.3e0d28ee.js";import{R as pe,n as Q,S as ce,P as me,B as he}from"../@element-plus/@element-plus.b73e6964.js";import{u as fe}from"../usr-image-cutter-dialog/usr-image-cutter-dialog.b5325ade.js";import{c as X}from"../CacheUtil/CacheUtil.c6ebddbe.js";import{u as ve}from"../usr-editor/usr-editor.e40bdb86.js";import{_ as H}from"../vue-img-cutter/vue-img-cutter.3d5e4c17.js";import{i as ge}from"../../assets/index-8c41d22a.js";import"../pinia/pinia.fb187a93.js";import"../@wangeditor/@wangeditor.654f9dc1.js";import"../element-plus/element-plus.b000c8d0.js";import"../lodash-es/lodash-es.21c98b27.js";import"../@vueuse/@vueuse.71e72d96.js";import"../@popperjs/@popperjs.c75af06c.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.10495895.js";import"../@kangc/@kangc.f59435d2.js";import"../vue/vue.1c0a12e0.js";import"../async-validator/async-validator.dee29e8b.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../escape-html/escape-html.66262ebd.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.72671fae.js";import"../vue-router/vue-router.6ed6991e.js";import"../localforage/localforage.9e9e3b2b.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../axios/axios.47b9d439.js";import"../echarts/echarts.3025caf6.js";import"../tslib/tslib.54e39b60.js";import"../zrender/zrender.7e5d4d80.js";import"../vue-echarts/vue-echarts.8b3ad32f.js";import"../resize-detector/resize-detector.a5205554.js";import"../nprogress/nprogress.d255c298.js";import"../highlight.js/highlight.js.1b3e8c39.js";const be={class:"preview_con_shop"},ye={class:"minapp_header"},we={class:"shop_carousel_list"},ke={class:"shop_info_panel"},Ve={class:"tit_panel"},xe={class:"tit_item price"},Ie={class:"price_real"},Ce={class:"tit_item tit"},Te={class:"share"},Ne={class:"share_con"},De={key:0,class:"tit_item desc"},Se={key:1,class:"tit_item tags"},ze={class:"sku_panel"},$e={style:{"padding-bottom":"10px"}},Ue={class:"sku_info"},Re={class:"sku_right"},qe={class:"choose_more_arrow"},We={class:"choose_time_panel"},Be={style:{"padding-bottom":"10px"}},Ee={class:"time_panel"},Ge={class:"choose_more_arrow"},Le={class:"detail_panel"},Pe=["innerHTML"],Fe={__name:"preview-shop",props:["shopInfo","preViewWidth"],setup(r){const N=(r.preViewWidth-40)*.7,w=c([{label:"天",value:"0",disabled:!1},{label:"月",value:"1",disabled:!0},{label:"小时",value:"2",disabled:!0}]);return(s,P)=>{const _=t("el-text"),W=t("el-image"),m=t("el-carousel-item"),p=t("el-carousel"),k=t("el-icon"),T=t("el-tag"),D=t("el-step"),S=t("el-steps"),z=t("el-tab-pane"),V=t("el-tabs"),B=t("el-scrollbar");return u(),g("div",be,[e(B,null,{default:l(()=>[o("div",ye,[o("span",null,[a("商品详情"),e(_,{type:"info"},{default:l(()=>[a("(预览)")]),_:1})])]),o("div",we,[e(p,{height:N+"px"},{default:l(()=>[(u(!0),g(E,null,G(r.shopInfo.thumbs,x=>(u(),y(m,{key:x.id},{default:l(()=>[e(W,{src:x.src,fit:"fill",style:{width:"100%"}},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["height"])]),o("div",ke,[o("div",Ve,[o("div",xe,[o("span",Ie,[e(_,null,{default:l(()=>[a("￥")]),_:1}),e(_,{style:{"font-size":"22px"},tag:"b"},{default:l(()=>[a(b(r.shopInfo.skus[0].price),1)]),_:1}),e(_,null,{default:l(()=>[a("/"+b(w.value[0].label),1)]),_:1})]),e(_,{type:"info",tag:"del",size:"small"},{default:l(()=>[a("￥"+b(r.shopInfo.skus[0].delPrice)+"/"+b(w.value[0].label),1)]),_:1})]),o("div",Ce,[e(_,{class:"txt",tag:"b"},{default:l(()=>[a(b(r.shopInfo.shopName),1)]),_:1}),o("div",Te,[o("div",Ne,[e(k,null,{default:l(()=>[e(q(pe))]),_:1}),e(_,{size:"small"},{default:l(()=>[a("分享")]),_:1})])])]),r.shopInfo.shopDesc!==""?(u(),g("div",De,[e(_,{type:"info",size:"small"},{default:l(()=>[a(b(r.shopInfo.shopDesc),1)]),_:1})])):L("",!0),r.shopInfo.tags.length>0?(u(),g("div",Se,[(u(!0),g(E,null,G(r.shopInfo.tags,x=>(u(),y(T,{key:x,type:"danger",size:"small",effect:"plain"},{default:l(()=>[a(b(x),1)]),_:2},1024))),128))])):L("",!0)]),o("div",ze,[o("div",$e,[e(_,{tag:"b"},{default:l(()=>[a("规格")]),_:1})]),o("div",Ue,[e(_,{class:"sku_name",type:"info",size:"small"},{default:l(()=>[a(b(r.shopInfo.skus[0].name),1)]),_:1}),o("div",Re,[e(_,{class:"sku_num",type:"info"},{default:l(()=>[a("x1")]),_:1}),o("div",qe,[e(k,null,{default:l(()=>[e(q(Q))]),_:1})])])])]),o("div",We,[o("div",Be,[e(_,{tag:"b"},{default:l(()=>[a("租赁周期")]),_:1})]),o("div",Ee,[e(S,{direction:"vertical",active:1,space:40},{default:l(()=>[e(D,{status:"wait"},{description:l(()=>[a(" 开始时间 : 2023-11-26 ")]),_:1}),e(D,{status:"wait"},{description:l(()=>[a(" 结束时间 : 2023-11-26 ")]),_:1})]),_:1}),o("div",Ge,[e(k,null,{default:l(()=>[e(q(Q))]),_:1})])])]),o("div",Le,[e(V,{model:0},{default:l(()=>[e(z,{label:"商品详情",class:"goods_detail"},{default:l(()=>[o("div",{innerHTML:r.shopInfo.shopDetail.val},null,8,Pe)]),_:1}),e(z,{label:"租赁流程"},{default:l(()=>[a("Config")]),_:1})]),_:1})])])]),_:1})])}}},Me=H(Fe,[["__scopeId","data-v-beeb23a5"]]);const Ae=r=>(ie("data-v-27fb1e66"),r=r(),ue(),r),Oe={class:"usr_cpt_panel_drawer_add_goods"},He=Ae(()=>o("h4",null,"添加商品",-1)),Ke={class:"dialog_con"},je={class:"page_left_con"},Qe={class:"preview"},Je={class:"preview_publish"},Xe={class:"page_right",style:{flex:"1"}},Ye={class:"page_right_con"},Ze={class:"add_goods_panel"},el={class:"shop_thumbs"},ll={class:"mask"},tl={__name:"goods-dialog-add",props:["dialog"],emits:["onConfirm"],setup(r,{emit:f}){const R=f,N=c(400),w=c(null),s=c({shopNo:"",shopName:"",shopDesc:"",tags:[],shopType:[],thumbs:[],unit:"0",skus:[{name:"",price:null,delPrice:null,count:null}],status:"1",shopDetail:{val:"<p></p>"}}),P=c([{label:"天",value:"0",disabled:!1},{label:"月",value:"1",disabled:!0},{label:"小时",value:"2",disabled:!0}]);J(()=>{W()});const _=c([]),W=()=>{X.getShopTypeExcludeDisabled().then(h=>{_.value.push(...h)}).catch(h=>{console.error(h)})},m=c(""),p=c(!1),k=c(null),T=h=>{s.value.tags.splice(s.value.tags.indexOf(h),1)},D=()=>{s.value.tags&&s.value.tags.push(m.value),p.value=!1,m.value=""},S=()=>{p.value=!0,ne(()=>{k.value&&k.value.focus()})},z=c({show:!1});let V=0;const B=h=>{V++,s.value.thumbs.push({id:V,src:h.dataURL}),w.value.validateField("thumbs")},x=()=>{z.value.show=!0},A=()=>{w.value.validateField("skus")},O=c({shopNo:[{required:!0,message:"编号不能为空！",trigger:"blur"}],shopName:[{required:!0,message:"商品名称不能为空！",trigger:"blur"},{min:8,max:40,message:"长度在 8 到 40 个字符",trigger:"blur"}],thumbs:[{required:!0,message:"商品图不能为空，请选择商品图！",trigger:"change"}],shopType:[{required:!0,message:"请选择商品分类",trigger:"change"}],unit:[{required:!0,message:"请选择价格单位",trigger:"change"}],skus:[{required:!0,validator:(h,i,U)=>{let I=!0;if(i.length===0)I=!1;else for(let v=0;v<i.length;v++)if(i[v].name===""||i[v].price===null||i[v].delPrice===null||i[v].count===null){I=!1;break}I?(console.log("规格验证通过"),U()):U(new Error("请完善规格信息！"))},trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),F=async()=>{try{await w.value.validate(),console.log("表单验证通过"),R("onConfirm",s.value)}catch{console.log("表单验证未通过")}};return(h,i)=>{const U=t("el-button"),I=t("el-input"),v=t("el-icon"),d=t("el-tooltip"),C=t("el-form-item"),Y=t("el-image"),Z=t("el-tag"),ee=t("el-cascader"),M=t("el-option"),K=t("el-select"),le=t("el-form"),j=t("el-scrollbar"),te=t("el-card"),oe=t("el-drawer");return u(),g("div",Oe,[e(oe,{modelValue:r.dialog.show,"onUpdate:modelValue":i[7]||(i[7]=n=>r.dialog.show=n),size:"80%",direction:"rtl",class:"usr_drawer_override"},{header:l(()=>[He]),default:l(()=>[e(j,null,{default:l(()=>[o("div",Ke,[o("div",{class:"page_left",style:ae({width:N.value+"px",minWidth:N.value+"px"})},[o("div",je,[o("div",Qe,[e(Me,{"pre-view-width":400,"shop-info":s.value},null,8,["shop-info"]),o("div",Je,[e(U,{type:"primary",size:"large",onClick:F},{default:l(()=>[a("保存 ")]),_:1})])])])],4),o("div",Xe,[o("div",Ye,[e(te,{shadow:"never",class:"usr_card_override"},{default:l(()=>[o("div",Ze,[e(j,null,{default:l(()=>[e(le,{model:s.value,ref_key:"formRef",ref:w,rules:O.value,"label-width":"120px"},{default:l(()=>[e(C,{label:"商品编号",prop:"shopNo",style:{"padding-top":"20px"},class:"shop_no"},{default:l(()=>[e(I,{modelValue:s.value.shopNo,"onUpdate:modelValue":i[0]||(i[0]=n=>s.value.shopNo=n),placeholder:"如：#123456",clearable:"",style:{width:"150px"}},null,8,["modelValue"]),e(d,{content:"商品编号为商品唯一标识，和其他商品不能重复！"},{default:l(()=>[e(v,{size:18,color:"#b1b3b8"},{default:l(()=>[e(q(ce))]),_:1})]),_:1})]),_:1}),e(C,{label:"商品名称",prop:"shopName"},{default:l(()=>[e(I,{modelValue:s.value.shopName,"onUpdate:modelValue":i[1]||(i[1]=n=>s.value.shopName=n),clearable:"",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),e(C,{label:"促销信息"},{default:l(()=>[e(I,{modelValue:s.value.shopDesc,"onUpdate:modelValue":i[2]||(i[2]=n=>s.value.shopDesc=n),autosize:{minRows:2,maxRows:4},type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"请输入简短的描述信息，100个字符以内！"},null,8,["modelValue"])]),_:1}),e(C,{label:"商品图",prop:"thumbs",class:"shop_images"},{default:l(()=>[o("div",el,[(u(!0),g(E,null,G(s.value.thumbs,n=>(u(),g("div",{class:"shop_img_list",key:n.id},[e(Y,{class:"shop_img",src:n.src,fit:"fill"},null,8,["src"]),o("span",ll,[e(v,null,{default:l(()=>[e(q(me))]),_:1})])]))),128)),s.value.thumbs.length<7?(u(),g("div",{key:0,class:"el-upload--picture-card",onClick:x},[e(v,null,{default:l(()=>[e(q(he))]),_:1})])):L("",!0)])]),_:1}),e(C,{class:"shop_tags",label:"商品标签"},{default:l(()=>[(u(!0),g(E,null,G(s.value.tags,n=>(u(),y(Z,{key:n,size:"large",closable:"","disable-transitions":!1,onClose:dl=>T(n)},{default:l(()=>[a(b(n),1)]),_:2},1032,["onClose"]))),128)),p.value?(u(),y(I,{key:0,modelValue:m.value,"onUpdate:modelValue":i[3]||(i[3]=n=>m.value=n),size:"default",ref_key:"tagInputRef",ref:k,onKeyup:se(D,["enter"]),onBlur:D,style:{width:"100px"}},null,8,["modelValue","onKeyup"])):(u(),y(U,{key:1,size:"default",onClick:S},{default:l(()=>[a(" + 添加标签 ")]),_:1}))]),_:1}),e(C,{label:"商品分类",prop:"shopType"},{default:l(()=>[e(ee,{props:{expandTrigger:"hover",value:"id",label:"name"},options:_.value,size:"default",modelValue:s.value.shopType,"onUpdate:modelValue":i[4]||(i[4]=n=>s.value.shopType=n),clearable:"",placeholder:"选择分类"},null,8,["options","modelValue"])]),_:1}),e(C,{label:"规格",prop:"skus",class:"sku_panel"},{default:l(()=>[e(_e,{skus:s.value.skus,onOnDelSkuRow:A},null,8,["skus"])]),_:1}),e(C,{label:"价格单位",prop:"unit"},{default:l(()=>[e(K,{modelValue:s.value.unit,"onUpdate:modelValue":i[5]||(i[5]=n=>s.value.unit=n),size:"default",clearable:"",placeholder:"选择单位"},{default:l(()=>[(u(!0),g(E,null,G(P.value,n=>(u(),y(M,{key:n.value,label:n.label,value:n.value,disabled:n.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"状态",prop:"status"},{default:l(()=>[e(K,{modelValue:s.value.status,"onUpdate:modelValue":i[6]||(i[6]=n=>s.value.status=n),clearable:"",size:"default",placeholder:"选择状态"},{default:l(()=>[e(M,{label:"已上架",value:"0"}),e(M,{label:"待上架",value:"1"}),e(M,{label:"已下架",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"商品描述"},{default:l(()=>[e(ve,{content:s.value.shopDetail,editor_width:""},null,8,["content"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])]),_:1})])]),e(fe,{dialog:z.value,onOnConfirm:B,"cut-width":300,"cut-height":210},null,8,["dialog"])])]),_:1})]),_:1},8,["modelValue"])])}}},ol=H(tl,[["__scopeId","data-v-27fb1e66"]]);const al={class:"page"},sl={class:"shop_name"},nl={class:"shop_type"},il={class:"action_btn"},ul={__name:"page-goods-manager",setup(r){const f=c({shopNo:"",shopName:"",shopType:[],status:""}),R=c(!0),N=c([]),w=c([]);J(()=>{s(),P()});const s=()=>{X.getShopTypeExcludeDisabled().then(m=>{w.value.push(...m)}).catch(m=>{console.error(m)})},P=()=>{R.value=!0,ge.get("data/goods.json").then(m=>{N.value=m.data.data}).catch(m=>{console.error(m)}).finally(()=>{R.value=!1})},_=c({show:!1}),W=()=>{_.value.show=!0};return(m,p)=>{const k=t("el-input"),T=t("el-form-item"),D=t("el-cascader"),S=t("el-option"),z=t("el-select"),V=t("el-button"),B=t("el-form"),x=t("el-card"),A=t("el-row"),$=t("el-table-column"),O=t("el-image"),F=t("el-text"),h=t("el-tag"),i=t("el-empty"),U=t("el-table"),I=t("el-pagination"),v=de("loading");return u(),g("div",al,[e(x,{shadow:"never",class:"usr_card_override top"},{default:l(()=>[e(B,{inline:!0,model:f.value},{default:l(()=>[e(T,{label:"编号"},{default:l(()=>[e(k,{modelValue:f.value.shopNo,"onUpdate:modelValue":p[0]||(p[0]=d=>f.value.shopNo=d),placeholder:"商品编号",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(T,{label:"名称"},{default:l(()=>[e(k,{modelValue:f.value.shopName,"onUpdate:modelValue":p[1]||(p[1]=d=>f.value.shopName=d),placeholder:"商品名称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(T,{label:"分类"},{default:l(()=>[e(D,{props:{expandTrigger:"hover",value:"id",label:"name"},options:w.value,size:"default",modelValue:f.value.shopType,"onUpdate:modelValue":p[2]||(p[2]=d=>f.value.shopType=d),clearable:"",placeholder:"选择分类"},null,8,["options","modelValue"])]),_:1}),e(T,{label:"状态"},{default:l(()=>[e(z,{modelValue:f.value.status,"onUpdate:modelValue":p[3]||(p[3]=d=>f.value.status=d),size:"default",placeholder:"选择状态",clearable:""},{default:l(()=>[e(S,{label:"已上架",value:"0"}),e(S,{label:"待上架",value:"1"}),e(S,{label:"已下架",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(T,null,{default:l(()=>[e(V,{type:"primary",plain:"",onClick:p[4]||(p[4]=()=>{})},{default:l(()=>[a("搜索")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(A,{class:"top_btn_panel"},{default:l(()=>[e(V,{type:"primary",onClick:W},{default:l(()=>[a("添加商品")]),_:1})]),_:1}),re((u(),y(x,{shadow:"never",class:"usr_card_override content"},{default:l(()=>[e(U,{class:"shop_table",data:N.value},{empty:l(()=>[e(i,{description:"暂无数据"})]),default:l(()=>[e($,{prop:"shopNo",label:"编号",sortable:"",width:"100"}),e($,{prop:"thumb",label:"缩略图","min-width":"150"},{default:l(d=>[e(O,{class:"goods_thumb",src:d.row.thumb},null,8,["src"])]),_:1}),e($,{label:"商品名称","min-width":"250"},{default:l(d=>[o("div",sl,[e(F,null,{default:l(()=>[a(b(d.row.shopName),1)]),_:2},1024)])]),_:1}),e($,{label:"分类",width:"180"},{default:l(d=>[o("div",nl,[e(F,null,{default:l(()=>[a(b(d.row.shopTypeName),1)]),_:2},1024)])]),_:1}),e($,{label:"状态",sortable:"",width:"120"},{default:l(d=>[d.row.status==="0"?(u(),y(h,{key:0},{default:l(()=>[a("已上架")]),_:1})):d.row.status==="1"?(u(),y(h,{key:1,type:"warning"},{default:l(()=>[a("待上架")]),_:1})):d.row.status==="2"?(u(),y(h,{key:2,type:"info"},{default:l(()=>[a("已下架")]),_:1})):L("",!0)]),_:1}),e($,{fixed:"right",label:"操作",width:"230"},{default:l(d=>[o("div",il,[e(V,{type:"success",plain:""},{default:l(()=>[a("编辑")]),_:1}),e(V,{type:"primary",plain:""},{default:l(()=>[a("详情")]),_:1}),e(V,{type:"danger",plain:""},{default:l(()=>[a("删除")]),_:1})])]),_:1})]),_:1},8,["data"]),e(I,{background:"",layout:"prev, pager, next",total:1e3})]),_:1})),[[v,R.value]]),_.value.show?(u(),y(ol,{key:0,dialog:_.value,onOnConfirm:p[5]||(p[5]=()=>{})},null,8,["dialog"])):L("",!0)])}}},Al=H(ul,[["__scopeId","data-v-b1c01ec8"]]);export{Al as default};
