import{u as O}from"../../assets/index-8de0b793.js";import{V as P}from"../vel-image-cutter-dialog/vel-image-cutter-dialog.a7432ebf.js";import{_ as H}from"../vue-img-cutter/vue-img-cutter.3d5e4c17.js";import{r as c,i as z,ah as a,o as p,c as B,W as e,Q as t,a as W,U as n,V as N,u as q,bi as j,bg as E,j as L,ar as M,R as Q,P as y,F as G,T as F}from"../@vue/@vue.5ea14220.js";import{c as J}from"../CacheUtil/CacheUtil.4072d4d9.js";import"../pinia/pinia.fb187a93.js";import"../vue-router/vue-router.6ed6991e.js";import"../localforage/localforage.9e9e3b2b.js";import"../@kangc/@kangc.f59435d2.js";import"../vue/vue.1c0a12e0.js";import"../js-cookie/js-cookie.edb2da2a.js";import"../axios/axios.47b9d439.js";import"../element-plus/element-plus.4f4b1701.js";import"../lodash-es/lodash-es.21c98b27.js";import"../@vueuse/@vueuse.71e72d96.js";import"../@element-plus/@element-plus.b73e6964.js";import"../@popperjs/@popperjs.c75af06c.js";import"../@ctrl/@ctrl.f8748455.js";import"../dayjs/dayjs.10495895.js";import"../async-validator/async-validator.dee29e8b.js";import"../memoize-one/memoize-one.297ddbcb.js";import"../escape-html/escape-html.66262ebd.js";import"../normalize-wheel-es/normalize-wheel-es.ed76fb12.js";import"../@floating-ui/@floating-ui.72671fae.js";import"../echarts/echarts.3025caf6.js";import"../tslib/tslib.54e39b60.js";import"../zrender/zrender.7e5d4d80.js";import"../vue-echarts/vue-echarts.8b3ad32f.js";import"../resize-detector/resize-detector.a5205554.js";import"../nprogress/nprogress.d255c298.js";import"../highlight.js/highlight.js.1b3e8c39.js";const K=m=>(j("data-v-1d4ed649"),m=m(),E(),m),X={class:"vel_cpt_panel_dialog_add_shop_type"},Y=K(()=>W("p",null,"预览",-1)),Z={class:"dialog-footer"},ee="100px",te={__name:"shop-type-dialog-add",props:["dialog","paramData"],emits:["onConfirm"],setup(m,{emit:C}){const _=m,b=C,f=_.dialog,D=_.paramData,d=c({show:!1}),o=c({parent:{id:0,name:"无"},status:"0",sort:1,name:"",icon:""}),w=c(null);z(()=>{o.value=D});const x=()=>{d.value.show=!0},V=v=>{o.value.icon=v.dataURL},r=async()=>{try{await w.value.validate(),b("onConfirm",o.value),k()}catch{console.log("表单验证未通过")}},k=()=>{f.show=!1,o.value.parent.id=0,o.value.parent.name="无",o.value.name="",o.value.icon="",o.value.status="0",o.value.sort=1},g=c({name:[{required:!0,message:"分类名称不能为空！",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]});return(v,i)=>{const T=a("el-text"),s=a("el-form-item"),S=a("el-input"),h=a("el-option"),I=a("el-select"),U=a("el-input-number"),R=a("el-image"),l=a("el-button"),$=a("el-form"),A=a("el-dialog");return p(),B("div",X,[e(A,{modelValue:q(f).show,"onUpdate:modelValue":i[3]||(i[3]=u=>q(f).show=u),title:o.value.parent.id===0?"创建分类":"添加子分类"},{footer:t(()=>[W("span",Z,[e(l,{onClick:k},{default:t(()=>[n("取消")]),_:1}),e(l,{type:"primary",onClick:r},{default:t(()=>[n("确定")]),_:1})])]),default:t(()=>[e($,{model:o.value,ref_key:"formRef",ref:w,rules:g.value,"label-width":ee},{default:t(()=>[e(s,{label:"父级分类"},{default:t(()=>[e(T,{tag:"b"},{default:t(()=>[n(N(o.value.parent.name),1)]),_:1})]),_:1}),e(s,{label:"分类名称",prop:"name"},{default:t(()=>[e(S,{modelValue:o.value.name,"onUpdate:modelValue":i[0]||(i[0]=u=>o.value.name=u),clearable:""},null,8,["modelValue"])]),_:1}),e(s,{label:"状态",prop:"status"},{default:t(()=>[e(I,{modelValue:o.value.status,"onUpdate:modelValue":i[1]||(i[1]=u=>o.value.status=u),size:"default",placeholder:"选择状态"},{default:t(()=>[e(h,{label:"正常",value:"0"}),e(h,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"排序",prop:"sort"},{default:t(()=>[e(U,{modelValue:o.value.sort,"onUpdate:modelValue":i[2]||(i[2]=u=>o.value.sort=u),size:"default","controls-position":"right"},null,8,["modelValue"])]),_:1}),e(s,{label:"图标",class:"el_form_item_cut_img"},{default:t(()=>[e(R,{class:"type_icon",src:o.value.icon},{error:t(()=>[Y]),_:1},8,["src"]),e(l,{onClick:x},{default:t(()=>[n("选择图片")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(P,{dialog:d.value,onOnConfirm:V,"cut-width":100,"cut-height":100},null,8,["dialog"])])}}},oe=H(te,[["__scopeId","data-v-1d4ed649"]]);const ae={class:"page"},le={class:"table_col_action"},ne={__name:"page-shop-type",setup(m){const C=O(),_=c(!0),b=c([]),f=L(()=>C.wh.h-90-40-42-42);z(()=>{D()});const D=()=>{_.value=!0,J.getShopType().then(r=>{b.value=r}).catch(r=>{console.error(r)}).finally(()=>{_.value=!1})},d=c({show:!1}),o=c({parent:{id:0,name:"无"},name:"",status:"0",sort:1,icon:""}),w=()=>{o.value.parent.id=0,o.value.parent.name="无",d.value.show=!0},x=r=>{o.value.parent.id=r.id,o.value.parent.name=r.name,d.value.show=!0},V=r=>{console.log("创建分类：--> "+r)};return(r,k)=>{const g=a("el-button"),v=a("el-row"),i=a("el-empty"),T=a("el-text"),s=a("el-table-column"),S=a("el-image"),h=a("el-tag"),I=a("el-table"),U=a("el-card"),R=M("loading");return p(),B("div",ae,[Q((p(),y(U,{shadow:"never",class:"vel_card_override"},{default:t(()=>[e(v,{style:{"margin-bottom":"10px"}},{default:t(()=>[e(g,{type:"primary",onClick:w},{default:t(()=>[n("创建分类")]),_:1})]),_:1}),e(I,{data:b.value,height:f.value,"row-key":"id","default-expand-all":""},{empty:t(()=>[e(i,{description:"暂无数据"})]),default:t(()=>[e(s,{prop:"name",label:"分类名称",width:"200"},{default:t(l=>[l.row.parent?(p(),y(T,{key:0,tag:"b"},{default:t(()=>[n(N(l.row.name),1)]),_:2},1024)):(p(),B(G,{key:1},[n(N(l.row.name),1)],64))]),_:1}),e(s,{prop:"icon",label:"图标",align:"center"},{default:t(l=>[e(S,{src:l.row.icon,style:{width:"50px",height:"50px"}},null,8,["src"])]),_:1}),e(s,{prop:"sort",label:"排序",align:"center"}),e(s,{label:"状态",align:"center"},{default:t(l=>[l.row.status===0?(p(),y(h,{key:0},{default:t(()=>[n("正常")]),_:1})):l.row.status===-1?(p(),y(h,{key:1,type:"info"},{default:t(()=>[n("停用")]),_:1})):F("",!0)]),_:1}),e(s,{label:"操作",fixed:"right","min-width":"200"},{default:t(l=>[W("div",le,[l.row.children?(p(),y(g,{key:0,type:"primary",plain:"",onClick:$=>x(l.row)},{default:t(()=>[n("添加子分类 ")]),_:2},1032,["onClick"])):F("",!0),e(g,{type:"success",plain:""},{default:t(()=>[n("编辑")]),_:1}),e(g,{type:"danger",plain:""},{default:t(()=>[n("删除")]),_:1})])]),_:1})]),_:1},8,["data","height"])]),_:1})),[[R,_.value]]),e(oe,{paramData:o.value,dialog:d.value,onOnConfirm:V},null,8,["paramData","dialog"])])}}},Fe=H(ne,[["__scopeId","data-v-34963534"]]);export{Fe as default};
